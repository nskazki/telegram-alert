# telegram-alert

`talert` - это реализация знакомого пользователям ubuntu алиаса `alert` для удаленных серверов.
Вы можете использовать его на удаленных серверах для получения уведомлений о завершении выполнения "долгих" команд через свой клиент телеграмма.

```bash
$ sleep 3; talert
```

## Использование
Для работы вам потребуются:
 * bash 
 * клиент [telegram](https://telegram.me/) на любом устройстве

Для начала использования:

1. Добавьте в свои контакты `@talertBot`
2. Отправьте `/login` для регистрации и генерации bash функций
3. Присланные функции добавьте в свой `~/.bashrc`
4. Обновите текущую bash сессию: `source ~/.bashrc`
5. Протестируйте работу `talert`: `sleep 3; talert`

## Локальное развертывание

Вам потребуются:
 * Сервер с белым ip
 * Установленный node.js и npm (приложение тестировалось на версии `node@0.12.7` и `node@5.4.1`)
 * Собственный телеграм бот
 * Локальный конфигурационный файл в директории проекта `configs/config.local.json`

Шаги развертывания:

1. Инструкция по установке node.js и npm: https://github.com/creationix/nvm
2. Инструкция по созданию бота: https://core.telegram.org/bots
3. Пример содержимого файла `config.local.json`: 
```js
{
  "botCtrl": {
    "token": "12923553:AAGbAfaAz25VkJ-RR1mox3fp5AFzWQDk",
    "publicAddress": "189.16.02.11:k{ httpCtrl.port }"
  },
  "httpCtrl": {
    "port": 11111
  }
}
```
 
Замечание: в поле `publicAddress` порт можно вписать явно.
Это может потребоваться, если ваш сервис `telegram-alert` будет стоять за NAT и слушать порт, отличный от порта, принимающего соединения из мира. 

После этого, находясь в корневой дирректории проекта, вам необходимо:
```bash
# установить зависимости
npm install
# протестировать проект
npm test
# запустить проект
# https://github.com/Unitech/pm2
npm i -g pm2
sudo mkdir -p /var/log/pm2/
sudo chown $USER:$USER /var/log/pm2/
pm2 start pm2/telegram-alert.json
```

Если все пройдет удачно, то у вас будет свой собственный телеграмм бот для отправки вам уведомлений.

## License

MIT
